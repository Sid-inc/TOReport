unit obj_select_form;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ComCtrls, obj_MM_form,
  Vcl.Buttons, FileCtrl, Vcl.ExtCtrls;

type
  Tobj_sel_form = class(TForm)
    Start_message: TLabel;
    Label_name: TLabel;
    obj_name: TEdit;
    MM: TRadioButton;
    MK: TRadioButton;
    MA: TRadioButton;
    Label_format: TLabel;
    next_button: TButton;
    destdesc: TLabel;
    destlock: TLabel;
    OpenDirBtn: TButton;
    Label_cashcount: TLabel;
    cash_count2: TRadioButton;
    cash_count3: TRadioButton;
    cash_count4: TRadioButton;
    cash_count5: TRadioButton;
    obj_type_gr: TPanel;
    cash_count_gr: TPanel;
    Label_apcount: TLabel;
    ap_count_gr: TPanel;
    ap_count1: TRadioButton;
    ap_count2: TRadioButton;
    ap_count3: TRadioButton;
    ap_count4: TRadioButton;
    ap_count5: TRadioButton;
    ap_count6: TRadioButton;
    Label_tsdcount: TLabel;
    Panel1: TPanel;
    tsd_count1: TRadioButton;
    tsd_count2: TRadioButton;
    tsd_count3: TRadioButton;
    tsd_count4: TRadioButton;
    Label_mpcount: TLabel;
    mp_count_gr: TPanel;
    mp_count1: TRadioButton;
    mp_count2: TRadioButton;
    mp_count3: TRadioButton;
    cash_count6: TRadioButton;
    watermark: TLabel;
    procedure next_buttonClick(Sender: TObject);
    procedure MMClick(Sender: TObject);
    procedure MKClick(Sender: TObject);
    procedure MAClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure OpenDirBtnClick(Sender: TObject);
    procedure cash_count2Click(Sender: TObject);
    procedure cash_count3Click(Sender: TObject);
    procedure cash_count4Click(Sender: TObject);
    procedure cash_count5Click(Sender: TObject);
    procedure tsd_count1Click(Sender: TObject);
    procedure tsd_count2Click(Sender: TObject);
    procedure tsd_count3Click(Sender: TObject);
    procedure tsd_count4Click(Sender: TObject);
    procedure mp_count1Click(Sender: TObject);
    procedure mp_count2Click(Sender: TObject);
    procedure mp_count3Click(Sender: TObject);
    procedure ap_count1Click(Sender: TObject);
    procedure ap_count2Click(Sender: TObject);
    procedure ap_count3Click(Sender: TObject);
    procedure ap_count4Click(Sender: TObject);
    procedure ap_count5Click(Sender: TObject);
    procedure ap_count6Click(Sender: TObject);
    procedure mp_count1DblClick(Sender: TObject);
    procedure mp_count2DblClick(Sender: TObject);
    procedure mp_count3DblClick(Sender: TObject);
    procedure cash_count6Click(Sender: TObject);


  private
    { Private declarations }
  public
    { Public declarations }
  end;

type
  TReport = class
    // Создаем класс TReport для хранения общей информации о отчете
  public
    Dlock: String; //Директория сохранения фото
    Rtype: string; // Свойство класса для хранения типа (ММ, МК, МА)
    OOname: string; // Название OO
    Cashcount: integer; // Свойство класса для хранения количества касс
    tsdcount: integer;  //Количество ТСД
    mpcount: integer;   //Количество мобильных принтеров
    apcount: integer;   //Количество точек доступа
    photos: array [1..200, 1..3] of string; // Массив для хранения данных о фото
  end;

var
  obj_sel_form: Tobj_sel_form;
  obj_type: integer;
  Report: TReport;

  cash, inside, insidemk, kkt, ibpmark, sksmount, allviewbuyer, allviewitems, allview, allviewstate,
    check, checkmk, nut, wifi, egais, bpmark, rout, allviewb, allviewf, allviewm,
    swith, pcdir, pcdirmk, pcserv, pcservmk, printconnect, a4prt, testpage, hub, hubtd, allitemsmark,
    ap, mp, tsd, view, mark, chklst, install, plan, prt, uks, ke, pc, ibp, pinpad, scan, hand, scales,
    floor_scales, mon19, a4scan, master, reserv: string;
  // Создаем строковые переменные чтобы хронить русский текст для названий файлов

implementation

{$R *.dfm}

procedure Tobj_sel_form.ap_count1Click(Sender: TObject);
begin
Report.apcount := 1;
end;

procedure Tobj_sel_form.ap_count2Click(Sender: TObject);
begin
Report.apcount := 2;
end;

procedure Tobj_sel_form.ap_count3Click(Sender: TObject);
begin
Report.apcount := 3;
end;

procedure Tobj_sel_form.ap_count4Click(Sender: TObject);
begin
Report.apcount := 4;
end;

procedure Tobj_sel_form.ap_count5Click(Sender: TObject);
begin
Report.apcount := 5;
end;

procedure Tobj_sel_form.ap_count6Click(Sender: TObject);
begin
Report.apcount := 6;
end;

procedure Tobj_sel_form.cash_count2Click(Sender: TObject);
begin
Report.Cashcount := 2;
end;

procedure Tobj_sel_form.cash_count3Click(Sender: TObject);
begin
Report.Cashcount := 3;
end;

procedure Tobj_sel_form.cash_count4Click(Sender: TObject);
begin
Report.Cashcount := 4;
end;

procedure Tobj_sel_form.cash_count5Click(Sender: TObject);
begin
Report.Cashcount := 5;
end;

procedure Tobj_sel_form.cash_count6Click(Sender: TObject);
begin
Report.Cashcount := 6;
end;

procedure Tobj_sel_form.FormCreate(Sender: TObject);
// При создании формы записываем русский текст в перменные
begin
  //кассы ММ
  cash := 'Касса';
  kkt := 'ККТ';
  ibpmark := 'Маркировка БП';
  sksmount := 'Монтаж СКС';
  allviewbuyer := 'Общий вид (покупатель)';
  allviewitems := 'Общий вид оборудование';
  allview := 'Общий вид';
  inside := 'Внутри';
  check := 'Чек';
  scales := 'Весы прикассовые';
  floor_scales := 'Весы напольные';
  //Для МК
  allitemsmark := 'Маркировка оборудования';
  insidemk := 'Обслуженная';
  checkmk := 'Фото Чека';
  //УКС для ММ
  uks := 'УКС';
  nut := 'Служба NUT';
  wifi := 'Голосовой шлюз';
  egais := 'ЕГАИС';
  bpmark := 'Маркировка БП';
  rout := 'Микротики';
  allviewb := 'Общий вид сзади';
  allviewf := 'Общий вид спереди';
  allviewm := 'Общий вид центр';
  allviewstate := 'Общий вид расположение';
  swith := 'Переключатель';
  pcdir := 'ПК Директора';
  pcserv := 'ПК Сервер';
  printconnect := 'Принтер подключение';
  a4prt := 'Принтер';
  testpage := 'Тестовая печать';
  hub := 'Хаб';
  hubtd := 'Хаб ТД';
  mon19 := 'Монитор';
  a4scan := 'Сканер А4';
  master := 'Роутер Мастер';
  reserv := 'Роутер Резерв';
  //УКС для МК
  pcdirmk := 'ПКД';
  pcservmk := 'Сервер';
  //Прочие фото
  ap := 'ТД';
  mp := 'МП';
  tsd := 'ТСД';
  view := 'Вид';
  mark := 'Маркировка';
  chklst := 'ЧЛ';
  install := 'Монтаж';
  plan := 'Планограмма';
  prt := 'Печать';
  ke := 'КЕ';
  pc := 'ПК';
  ibp := 'ИБП';
  pinpad := 'Пин Пад';
  scan := 'Сканер ШК';
  hand := 'Ручной Сканер ШК';


  Report := TReport.Create;
  Report.Cashcount := 1; //По умолчанию 1 касса
  Report.mpcount := 1;   //По умолчанию 1 МП
  Report.apcount := 1;   //По умолчанию 1 ТД
  Report.tsdcount := 1;  //По умолчанию 1 ТСД
  // Создание глобального объекта Report класса TReport для доступа к тему из любой части программы
end;

procedure Tobj_sel_form.FormShow(Sender: TObject);
begin
  obj_type := 0;
end;

procedure Tobj_sel_form.MAClick(Sender: TObject);
begin
  obj_type := 3;
  cash_count2.Checked := True;
  tsd_count1.Checked := True;
  ap_count1.Checked := True;
  mp_count1.Checked := False;
  mp_count2.Checked := False;
  mp_count3.Checked := False;
end;

procedure Tobj_sel_form.MKClick(Sender: TObject);
begin
  obj_type := 2;
  cash_count2.Checked := True;
  tsd_count1.Checked := True;
  ap_count1.Checked := True;
  mp_count1.Checked := True;
  end;

procedure Tobj_sel_form.MMClick(Sender: TObject);
begin
  obj_type := 1;
  cash_count3.Checked := True;
  tsd_count2.Checked := True;
  ap_count3.Checked := True;
  mp_count1.Checked := True;
  end;

procedure Tobj_sel_form.mp_count1Click(Sender: TObject);
begin
Report.mpcount := 1;
end;

procedure Tobj_sel_form.mp_count1DblClick(Sender: TObject);
begin
if obj_type = 3 then
mp_count1.Checked := False;
Report.mpcount := 0;
end;

procedure Tobj_sel_form.mp_count2Click(Sender: TObject);
begin
Report.mpcount := 2;
end;

procedure Tobj_sel_form.mp_count2DblClick(Sender: TObject);
begin
if obj_type = 3 then
mp_count2.Checked := False;
Report.mpcount := 0;
end;

procedure Tobj_sel_form.mp_count3Click(Sender: TObject);
begin
Report.mpcount := 3;
end;

procedure Tobj_sel_form.mp_count3DblClick(Sender: TObject);
begin
if obj_type = 3 then
mp_count3.Checked := False;
Report.mpcount := 0;
end;

procedure Tobj_sel_form.next_buttonClick(Sender: TObject);
begin
  if obj_name.Text <> '' then
     Report.OOname := obj_name.Text
    // Если в поле названия магазина что-то есть, записываем это название в глобальный объект
    else
      begin
      ShowMessage('Введите название объекта!');
      // Если в поле пусто, выдаем предупреждение
      Exit;
      // Прерываем дальнейшее выполнение
      end;
  if obj_type = 0 then
     begin
       ShowMessage('Не выбран формат ОО!');
       Exit;
     end;
  if destlock.Caption = '..' then
      begin
      ShowMessage('Не выбрана папка сохранения фото!');
      Exit;
      end;
  if Report.Cashcount <= 1 then
    //Если выбран чекбокс с количеством касс продолжаем
    begin
    ShowMessage('Выберете количество касс!');
    Exit;
    end;


  case obj_type of
    1:
      begin
        Report.Rtype := 'MM'; // Записываем тип отчета в глобальный объект
        obj_MM.Show;
        obj_sel_form.Hide;
      end;
    2:
      begin
        Report.Rtype := 'MK'; // Записываем тип отчета в глобальный объект
        obj_MM.Show;
        obj_sel_form.Hide;
      end;
    3:
      begin
        ShowMessage('Форма для МА в разработке..');
        //obj_MM.Show;
        //obj_sel_form.Hide;
        //Report.Rtype := 'МА'; // Записываем тип отчета в глобальный объект
      end;
    
  end;

  obj_MM.object_name.Caption := Report.Rtype + ' ' +
    obj_select_form.Report.OOname;
  // Выводим в названии второй формы название и тип ОО
end;

procedure Tobj_sel_form.OpenDirBtnClick(Sender: TObject);
var
  dir: String;
begin
  if SelectDirectory ('Выберите папку, для сохранения обработанных фото:', '', dir) then
    begin
    destlock.Caption := dir;
    Report.Dlock := dir;  //передаем классу информацию о пути сохранения фото
    end;
end;
procedure Tobj_sel_form.tsd_count1Click(Sender: TObject);
begin
Report.tsdcount := 1;
end;

procedure Tobj_sel_form.tsd_count2Click(Sender: TObject);
begin
Report.tsdcount := 2;
end;

procedure Tobj_sel_form.tsd_count3Click(Sender: TObject);
begin
Report.tsdcount := 3;
end;

procedure Tobj_sel_form.tsd_count4Click(Sender: TObject);
begin
Report.tsdcount := 4;
end;

end.
