unit obj_select_form;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ComCtrls, obj_MM_form,
  Vcl.Buttons, FileCtrl;

type
  Tobj_sel_form = class(TForm)
    Start_message: TLabel;
    Label_name: TLabel;
    obj_name: TEdit;
    MM: TRadioButton;
    MK: TRadioButton;
    MA: TRadioButton;
    Label_format: TLabel;
    next_button: TButton;
    destdesc: TLabel;
    destlock: TLabel;
    OpenDirBtn: TButton;
    Label_cashcount: TLabel;
    cash_count2: TRadioButton;
    cash_count3: TRadioButton;
    cash_count4: TRadioButton;
    cash_count5: TRadioButton;
    procedure next_buttonClick(Sender: TObject);
    procedure MMClick(Sender: TObject);
    procedure MKClick(Sender: TObject);
    procedure MAClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure OpenDirBtnClick(Sender: TObject);
    procedure cash_count2Click(Sender: TObject);
    procedure cash_count3Click(Sender: TObject);
    procedure cash_count4Click(Sender: TObject);
    procedure cash_count5Click(Sender: TObject);


  private
    { Private declarations }
  public
    { Public declarations }
  end;

type
  TReport = class
    // Создаем класс TReport для хранения общей информации о отчете
  public
    Dlock: String; //Директория сохранения фото
    Rtype: string; // Свойство класса для хранения типа (ММ, МК, МА)
    OOname: string; // Название OO
    Cashcount: integer; // Свойство класса для хранения количества касс
  end;

var
  obj_sel_form: Tobj_sel_form;
  obj_type: integer;
  cashnum: integer;
  Report: TReport;

  cash, Inside, kkt, ibpmark, sksmount, allviewbuyer, allviewitems, allview,
    check: string;
  // Создаем строковые переменные чтобы хронить русский текст для названий файлов

implementation

{$R *.dfm}

procedure Tobj_sel_form.cash_count2Click(Sender: TObject);
begin
cashnum := 2;
end;

procedure Tobj_sel_form.cash_count3Click(Sender: TObject);
begin
cashnum := 3;
end;

procedure Tobj_sel_form.cash_count4Click(Sender: TObject);
begin
cashnum := 4;
end;

procedure Tobj_sel_form.cash_count5Click(Sender: TObject);
begin
cashnum := 5;
end;

procedure Tobj_sel_form.FormCreate(Sender: TObject);
// При создании формы записываем русский текст в перменные
begin
  cash := 'Касса';
  Inside := 'Внутри';
  kkt := 'ККТ';
  ibpmark := 'Маркировка БП';
  sksmount := 'Монтаж СКС';
  allviewbuyer := 'Общий вид (покупатель)';
  allviewitems := 'Общий вид Оборудование';
  allview := 'Общий вид';
  check := 'Чек';

  Report := TReport.Create;
  // Создание глобального объекта Report класса TReport для доступа к тему из любой части программы
end;

procedure Tobj_sel_form.FormShow(Sender: TObject);
begin
  obj_type := 0;
  cashnum := 1;
end;

procedure Tobj_sel_form.MAClick(Sender: TObject);
begin
  obj_type := 3;
end;

procedure Tobj_sel_form.MKClick(Sender: TObject);
begin
  obj_type := 2;
end;

procedure Tobj_sel_form.MMClick(Sender: TObject);
begin
  obj_type := 1;
end;

procedure Tobj_sel_form.next_buttonClick(Sender: TObject);
begin
  if obj_name.Text <> '' then
     Report.OOname := obj_name.Text
    // Если в поле названия магазина что-то есть, записываем это название в глобальный объект
    else
      begin
      ShowMessage('Введите название объекта!');
      // Если в поле пусто, выдаем предупреждение
      Exit;
      // Прерываем дальнейшее выполнение
      end;
  if obj_type = 0 then
     begin
       ShowMessage('Не выбран формат ОО!');
       Exit;
     end;
  if destlock.Caption = '..' then
      begin
      ShowMessage('Не выбрана папка сохранения фото!');
      Exit;
      end;
  if cashnum > 1 then
    Report.Cashcount := cashnum
    else
    begin
    ShowMessage('Выберете количество касс!');
    Exit;
    end;


  case obj_type of
    1:
      begin
        obj_MM.Show;
        obj_sel_form.Hide;
        Report.Rtype := 'ММ'; // Записываем тип отчета в глобальный объект
      end;
    2:
      begin
        ShowMessage('Форма для МК в разработке..');
        //obj_MM.Show;
        //obj_sel_form.Hide;
        //Report.Rtype := 'МК'; // Записываем тип отчета в глобальный объект
      end;
    3:
      begin
        ShowMessage('Форма для МА в разработке..');
        //obj_MM.Show;
        //obj_sel_form.Hide;
        //Report.Rtype := 'МА'; // Записываем тип отчета в глобальный объект
      end;
    
  end;

  obj_MM.object_name.Caption := obj_select_form.Report.Rtype + ' ' +
    obj_select_form.Report.OOname;
  // Выводим в названии второй формы название и тип ОО
end;

procedure Tobj_sel_form.OpenDirBtnClick(Sender: TObject);
var
  dir: String;
begin
  if SelectDirectory ('Выберите папку, для сохранения обработанных фото:', '', dir) then
    begin
    destlock.Caption := dir;
    Report.Dlock := dir;
    end;
end;
end.
